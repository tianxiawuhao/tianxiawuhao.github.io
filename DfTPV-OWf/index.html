<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" />
<meta name="referrer" content="never">
<meta name="keywords" content="">
<meta name="description" content="欢迎访问[tianxia]的个人博客">
<meta name="author" content="kveln">
<title>Gitlab的手动安装 | tianxia</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">
<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link
  href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'
  rel='stylesheet' type='text/css'>
<link rel="alternate" type="application/rss+xml" title="Gitlab的手动安装 | tianxia » Feed"
  href="https://tianxiawuhao.github.io/atom.xml">
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.10/build/styles/androidstudio.min.css">
<link href="https://tianxiawuhao.github.io/styles/main.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/850552586/ericamcdn@0.1/css/live2d.css">

<script>hljs.initHighlightingOnLoad();</script>

  <meta property="og:description" content="Gitlab的手动安装" />
  <meta property="og:url" content="https://tianxiawuhao.github.io/DfTPV-OWf/" />
  <meta property="og:locale" content="zh-CN" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="tianxia" />
  <!-- <script src="../assets/styles/scripts/tocScript.js"></script> -->
</head>

<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://tianxiawuhao.github.io">tianxia</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://tianxiawuhao.github.io">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/archives">归档</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/tags">标签</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1742729663519"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <!-- Page Header -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://tianxiawuhao.github.io">tianxia</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="https://tianxiawuhao.github.io">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/archives">归档</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/tags">标签</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1742729663519"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
<header class="masthead" style="background-image: url('https://tianxiawuhao.github.io/media/images/home-bg.jpg')">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        
          <!-- 没Title为其他页面Header -->
          
            <!-- 没Title并且有headerType为Post：文章Header -->
            <div class="post-heading">
              <span class="tags">
                
                <a href="https://tianxiawuhao.github.io/NdxF1vK3u/" class="tag">运维</a>
                
              </span>
              <h1>Gitlab的手动安装</h1>
              <span class="meta">
                Posted on
                2022-11-24，15 min read
              </span>
            </div>
          
        
      </div>
    </div>
  </div>
</header>
  <!-- Post Content -->
  <article id="post-content-article">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto post-content-container">
          
          <img class="post-feature-header-image" src="https://tianxiawuhao.github.io/post-images/DfTPV-OWf.png" alt="封面图">
          </img>
          
          <blockquote>
<p>对于这一类的基础服务，我还是绝得手动安装得方式更能让我心安！</p>
<p>docker安装的文章，参考这里：<a href=""> GitLab的安装与简单使用 </a></p>
</blockquote>
<hr>
<h3 id="一-使用清华镜像源安装"><strong>一、使用清华镜像源安装</strong></h3>
<p>清华镜像源：https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/</p>
<p>清华镜像源给的使用教程：https://mirror.tuna.tsinghua.edu.cn/help/gitlab-ce/</p>
<p>开始安装！</p>
<p><strong>1、配置yum源：</strong></p>
<pre><code class="language-shell">vim /etc/yum.repos.d/gitlab-ce.repo
 
# 复制粘贴以下内容：
[gitlab-ce]
name=Gitlab CE Repository
baseurl=https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el$releasever/
gpgcheck=0
enabled=1
</code></pre>
<p><strong>2、再执行以下两步：</strong></p>
<pre><code class="language-shell">sudo yum makecache
 
sudo yum install gitlab-ce #自动安装最新版
# sudo yum install gitlab-ce-x.x.x #安装指定版本
 
#查看gitlab的版本：
cat /opt/gitlab/embedded/service/gitlab-rails/VERSION
 
#卸载当前版本：
gitlab-ctl uninstall
yum remove gitlab-ce
 
#安装指定版本：
#具体版本信息可通过该链接查看：https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/
sudo yum install gitlab-ce-14.7.0-ce.0.el7.x86_64
</code></pre>
<hr>
<h3 id="二-gitlab的启动和常用命令"><strong>二、Gitlab的启动和常用命令</strong></h3>
<p><strong>1、Gitlab的配置文件位置：/etc/gitlab/gitlab.rb</strong></p>
<pre><code class="language-shell">vim /etc/gitlab/gitlab.rb
 
配置外部访问域名：
external_url 'http://gitlab.jiguiquan.com'
</code></pre>
<p><strong>2、使配置重新生效并启动</strong></p>
<pre><code class="language-shell">gitlab-ctl reconfigure
 
# 关于初始账号密码的提示：
Notes:
Default admin account has been configured with following details:
Username: root
Password: You didn't opt-in to print initial root password to STDOUT.
Password stored to /etc/gitlab/initial_root_password. This file will be cleaned up in first reconfigure run after 24 hours.
 
# 查看状态
gitlab-ctl status
</code></pre>
<p><strong>3、gitlab的其它常用命令：</strong></p>
<pre><code class="language-shell">gitlab-ctl start    # 启动所有 gitlab 组件；
gitlab-ctl stop        # 停止所有 gitlab 组件；
gitlab-ctl restart        # 重启所有 gitlab 组件；
gitlab-ctl status        # 查看服务状态；
vim /etc/gitlab/gitlab.rb        # 修改gitlab配置文件；
gitlab-ctl reconfigure        # 重新编译gitlab的配置；
gitlab-rake gitlab:check SANITIZE=true --trace    # 检查gitlab；
gitlab-ctl tail        # 查看日志；
gitlab-ctl tail nginx/gitlab_access.log
</code></pre>
<hr>
<h3 id="三-gitlab502问题解决思路"><strong>三、Gitlab502问题解决思路</strong></h3>
<figure data-type="image" tabindex="1"><img src="https://tianxiawuhao.github.io/post-images/1643085368291752.png" alt="image.png" loading="lazy"></figure>
<p>因为Gitlab里面涉及到的服务太多了，所以可能导致的原因很多很多，所以只将思路；</p>
<p><strong>1、纯粹就是启动慢，一定要给它时间！</strong></p>
<p><strong>2、正常情况下最容易碰到的问题是，端口被占用：</strong></p>
<p><strong>2.1、查看服务状态</strong></p>
<pre><code class="language-shell">[root@tcosmo-szls01 gitlab]# gitlab-ctl status
run: alertmanager: (pid 47345) 3083s; run: log: (pid 39732) 4609s
run: gitaly: (pid 47374) 3083s; run: log: (pid 38290) 4745s
run: gitlab-exporter: (pid 47436) 3083s; run: log: (pid 39461) 4629s
run: gitlab-workhorse: (pid 47464) 3082s; run: log: (pid 39111) 4650s
run: grafana: (pid 60395) 567s; run: log: (pid 40223) 4561s
run: logrotate: (pid 47533) 3081s; run: log: (pid 38080) 4763s
run: nginx: (pid 60308) 568s; run: log: (pid 39286) 4645s
run: node-exporter: (pid 47624) 3080s; run: log: (pid 39395) 4635s
run: postgres-exporter: (pid 47630) 3080s; run: log: (pid 39834) 4605s
run: postgresql: (pid 47640) 3080s; run: log: (pid 38465) 4733s
run: prometheus: (pid 47644) 3079s; run: log: (pid 39641) 4617s
run: puma: (pid 62674) 27s; run: log: (pid 38876) 4664s
run: redis: (pid 47731) 3079s; run: log: (pid 38133) 4752s
run: redis-exporter: (pid 47740) 3078s; run: log: (pid 39567) 4621s
run: sidekiq: (pid 60222) 585s; run: log: (pid 38910) 4658s
</code></pre>
<p><strong>2.2、看到puma服务启动时间不正常，所以我们详细的查看puma服务的日志：</strong></p>
<pre><code class="language-shell">[root@tcosmo-szls01 gitlab]# gitlab-ctl tail puma
2022-01-25_04:25:18.93538   /opt/gitlab/embedded/bin/puma:23:in `&lt;top (required)&gt;'
2022-01-25_04:25:19.82282 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;Puma starting in cluster mode...&quot;}
2022-01-25_04:25:19.82285 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;* Puma version: 5.5.2 (ruby 2.7.5-p203) (\&quot;Zawgyi\&quot;)&quot;}
2022-01-25_04:25:19.82285 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;*  Min threads: 4&quot;}
2022-01-25_04:25:19.82286 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;*  Max threads: 4&quot;}
2022-01-25_04:25:19.82286 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;*  Environment: production&quot;}
2022-01-25_04:25:19.82287 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;*   Master PID: 62825&quot;}
2022-01-25_04:25:19.82289 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;*      Workers: 80&quot;}
2022-01-25_04:25:19.82290 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;*     Restarts: (✔) hot (✖) phased&quot;}
2022-01-25_04:25:19.82293 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:19.822Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;* Preloading application&quot;}
2022-01-25_04:25:53.14976 {&quot;timestamp&quot;:&quot;2022-01-25T04:25:53.149Z&quot;,&quot;pid&quot;:62825,&quot;message&quot;:&quot;* Listening on unix:///var/opt/gitlab/gitlab-rails/sockets/gitlab.socket&quot;}
2022-01-25_04:25:53.14993 bundler: failed to load command: puma (/opt/gitlab/embedded/bin/puma)
2022-01-25_04:25:53.14999 Errno::EADDRINUSE: Address already in use - bind(2) for &quot;127.0.0.1&quot; port 8080
 
## 罪魁祸首在这里，puma服务默认需要使用8080端口，但是8080端口被占用了
</code></pre>
<p><strong>2.3、解决问题</strong></p>
<p>如果不是主要服务，我们就可以把那个服务停掉；</p>
<p>如果不能停，那我们就去修改puma服务默认的端口</p>
<pre><code class="language-shell">vim /etc/gitlab/gitlab.rb
 
# 修改puma服务默认的端口
### Advanced settings
# puma['listen'] = '127.0.0.1'
 puma['port'] = 8090  ## 这里
# puma['socket'] = '/var/opt/gitlab/gitlab-rails/sockets/gitlab.socket'
# puma['somaxconn'] = 1024
 
# 之后我们让配置生效并重启服务
gitlab-ctl reconfigure
</code></pre>
<p>之后服务就可以正常访问了：</p>
<figure data-type="image" tabindex="2"><img src="https://tianxiawuhao.github.io/post-images/1643085914153837.png" alt="image.png" loading="lazy"></figure>
<hr>
<h3 id="四-gitlab的使用"><strong>四、Gitlab的使用</strong></h3>
<p><strong>1、获得初始密码，并修改初始root密码：</strong></p>
<pre><code class="language-shell">[root@tcosmo-szls01 gitlab]# cat /etc/gitlab/initial_root_password|grep Password:
Password: bimCiS46btIEfFn/03A0gVA8EuriTjuRrqtJhwvl5vo=
</code></pre>
<p>登录后立即修改初始密码：</p>
<figure data-type="image" tabindex="3"><img src="https://tianxiawuhao.github.io/post-images/1643086592401899.png" alt="image.png" loading="lazy"></figure>
<p><strong>2、Gitlab的几个重要目录</strong></p>
<pre><code class="language-shell">配置文件目录：/etc/gitlab/
日志文件目录：/var/log/gitlab/
data数据目录：/var/opt/gitlab/
</code></pre>
<hr>
<p><strong>补充一：重要：Gitlab的数据备份：</strong></p>
<p><strong>1、手动备份：</strong></p>
<pre><code class="language-shell">gitlab-rake gitlab:backup:create
 
# 上面的命令会将gitlab的数据备份到//var/opt/gitlab/backups目录下，包含：gitlab仓库、数据库、用户、用户组、用户密钥、权限等完整信息。
[root@tcosmo-szls01 backups]# pwd
/var/opt/gitlab/backups
[root@tcosmo-szls01 backups]# ll -h
total 243M
-rw------- 1 git git 243M Apr 19 18:19 1650363597_2022_04_19_14.7.0_gitlab_backup.tar
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://tianxiawuhao.github.io/post-images/1650363718267634.png" alt="image.png" loading="lazy"></figure>
<p><strong>2、自动备份（每天凌晨4点执行备份，且只保留7天）</strong></p>
<p><strong>2.1、修改备份有效期，只保留7天</strong></p>
<pre><code class="language-shell">vim /etc/gitlab/gitlab.rb
# 显示行号 :set nu
 
# 大概在564行：
gitlab_rails['backup_keep_time'] = 604800   ##配置为7天
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://tianxiawuhao.github.io/post-images/1650364652505387.png" alt="image.png" loading="lazy"></figure>
<p>配置完成后，执行以下命令使配置生效：</p>
<pre><code class="language-shell">gitlab-ctl reconfigure
</code></pre>
<figure data-type="image" tabindex="6"><img src="https://tianxiawuhao.github.io/post-images/1650364844953219.png" alt="image.png" loading="lazy"></figure>
<p><strong>2.2、借助系统crontab命令实现每天凌晨4点定时备份：</strong></p>
<pre><code class="language-shell">vim /etc/crontab
0 4 * * * root /opt/gitlab/bin/gitlab-rake gitlab:backup:create CRON=1
</code></pre>
<figure data-type="image" tabindex="7"><img src="https://tianxiawuhao.github.io/post-images/1650365037997032.png" alt="image.png" loading="lazy"></figure>
<p>重启crontab服务：</p>
<pre><code class="language-shell">systemctl restart crond
</code></pre>
<p><strong>3、接下来就是重要的恢复时刻啦：</strong></p>
<p><strong>3.1、首先将其它地方的备份文件拷贝到目标gitlab的 /var/opt/gitlab/backups/ 目录下：</strong></p>
<pre><code class="language-shell">[root@tcosmo-szlstb03 backups]# pwd
/var/opt/gitlab/backups
 
[root@tcosmo-szlstb03 backups]# chmod 777 1652558427_2022_05_15_14.7.0_gitlab_backup.tar  #修改下此文件的权限
 
[root@tcosmo-szlstb03 backups]# ll
total 463020
-rwxrwxrwx 1 root root 474132480 May 15 14:00 1652558427_2022_05_15_14.7.0_gitlab_backup.tar
</code></pre>
<p><strong>3.2、停止数据库连接服务：</strong></p>
<pre><code class="language-shell">[root@tcosmo-szlstb03 backups]# gitlab-ctl stop puma &amp;&amp; gitlab-ctl stop sidekiq
ok: down: puma: 0s, normally up
ok: down: sidekiq: 0s, normally up
 
[root@tcosmo-szlstb03 backups]# gitlab-ctl status
run: alertmanager: (pid 127725) 2368s; run: log: (pid 125865) 2462s
run: gitaly: (pid 127446) 2376s; run: log: (pid 124540) 2594s
run: gitlab-exporter: (pid 127391) 2379s; run: log: (pid 125602) 2482s
run: gitlab-kas: (pid 134202) 1829s; run: log: (pid 124881) 2579s
run: gitlab-workhorse: (pid 127361) 2380s; run: log: (pid 125421) 2499s
run: grafana: (pid 134276) 1828s; run: log: (pid 126913) 2407s
run: logrotate: (pid 124415) 2609s; run: log: (pid 124450) 2608s
run: nginx: (pid 134237) 1828s; run: log: (pid 125463) 2493s
run: node-exporter: (pid 127384) 2380s; run: log: (pid 125570) 2488s
run: postgres-exporter: (pid 127739) 2367s; run: log: (pid 126033) 2456s
run: postgresql: (pid 124683) 2586s; run: log: (pid 124695) 2585s
run: prometheus: (pid 131596) 2155s; run: log: (pid 125676) 2470s
down: puma: 29s, normally up; run: log: (pid 125345) 2511s
run: redis: (pid 124479) 2603s; run: log: (pid 124491) 2602s
run: redis-exporter: (pid 127393) 2379s; run: log: (pid 125625) 2476s
down: sidekiq: 29s, normally up; run: log: (pid 125370) 2505s
</code></pre>
<p><strong>3.3、之前restore备份恢复操作：</strong></p>
<pre><code class="language-shell">[root@tcosmo-szlstb03 backups]# gitlab-rake gitlab:backup:restore BACKUP=1652558427_2022_05_15_14.7.0
2022-05-15 14:15:58 +0800 -- Unpacking backup ... 
2022-05-15 14:15:59 +0800 -- Unpacking backup ... done
GitLab version mismatch:
  Your current GitLab version (14.10.2) differs from the GitLab version in the backup!
  Please switch to the following version and try again:
  version: 14.7.0
</code></pre>
<blockquote>
<p>这里的意思是，目标GItlab版本与备份文件版本不一致，所以Gitlab的备份恢复必须保持Gitlab版本一致！</p>
<p>乖乖切换对应的Gitlab版本吧！</p>
</blockquote>
<p><strong>3.4、最后重启下Gitlab吧：</strong></p>
<pre><code class="language-shell">gitlab-ctl start
</code></pre>
<hr>
<p><strong>补充二、Gitlab一些细节配置</strong></p>
<p><strong>1、Gitlab仓库允许的最大上传文件配置：</strong></p>
<p>修改核心配置文件/etc/gitlab/gitlab.rb中的Nginx配置：</p>
<pre><code class="language-shell">vim /etc/gitlab/gitlab.rb
 
nginx['client_max_body_size'] = '1024m'
 
#然后重启服务
gitlab-ctl reconfigure
</code></pre>
<hr>
<p><strong>补充三、Gitlab之Git LFS大文件存储</strong></p>
<p><strong>1、修改gitlab核心配置文件：</strong></p>
<pre><code class="language-shell">vim config/gitlab.yml:
  
### Git LFS
gitlab_rails['lfs_enabled'] = true
#默认位置：`/var/opt/gitlab/gitlab-rails/shared/lfs-objects`
gitlab_rails['lfs_storage_path'] = &quot;/data/gitlab/lfs-objects&quot;
</code></pre>
<p><strong>2、重启gitlab：</strong></p>
<pre><code class="language-shell">gitlab-ctl reconfigure
</code></pre>
<p><strong>3、之后正常情况下，所有的项目就都支持LFS了，也可以关闭：</strong></p>
<p><strong><img src="https://tianxiawuhao.github.io/post-images/1657787443722860.png" alt="image.png" loading="lazy"></strong></p>
<p><strong>4、通过管理员账号Admin Area——&gt;overview——&gt;project时，还可以看到项目的详细预览信息：</strong></p>
<p><strong>5、在推送代码时，需要执行git lfs track 命令指定存入lfs的文件后缀：</strong></p>
<p>现在我将要测试上传一个大文件 + 小文件到gitlab，同时让大文件存放到“/data/gitlab/lfs-objects”</p>
<pre><code class="language-shell"># 标记哪些文件需要通过lfs存储
$ git lfs track &quot;*.vep&quot;
Tracking &quot;*.vep&quot;
 
# 查看自动生成得.gitattributes文件
$ cat .gitattributes
*.vep filter=lfs diff=lfs merge=lfs -text
 
# 添加文件
$ git add .
 
# commit提交
$ git commit -m &quot;first test large file&quot;
[main 3357c89] first test large file
 3 files changed, 5 insertions(+)
 create mode 100644 .gitattributes
 create mode 100644 big-file.vep
 create mode 100644 small-file.txt
 
# push到远程gitlab
$ git push origin main
info: detecting host provider for 'http://10.206.73.159/'...
info: detecting host provider for 'http://10.206.73.159/'...
info: detecting host provider for 'http://10.206.73.159/'...
info: detecting host provider for 'http://10.206.73.159/'...
Locking support detected on remote &quot;origin&quot;. Consider enabling it with:
  $ git config lfs.http://10.206.73.159/jiguiquan/test-big-file.git/info/lfs.locksverify true
Uploading LFS objects:   0% (0/1), 37 MB | 3.3 MB/s
...
Uploading LFS objects:   0% (0/1), 862 MB | 3.6 MB/s
...
Uploading LFS objects: 100% (1/1), 1.3 GB | 3.7 MB/s, done.
Enumerating objects: 6, done.
Counting objects: 100% (6/6), done.
Delta compression using up to 4 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (5/5), 540 bytes | 270.00 KiB/s, done.
Total 5 (delta 0), reused 0 (delta 0), pack-reused 0
To http://10.206.73.159/jiguiquan/test-big-file.git
   ac6319f..3357c89  main -&gt; main
</code></pre>
<p><strong>6、上传文成后，我们去Gitlab中查看，可以看到对应的大文件有个特殊小标志：</strong></p>
<p>同时，LFS大文件时无法在代码中直接删除的！</p>
<p><strong>7、到我们配置得LFS路径下看看，是不是确实有这个大文件：</strong></p>
<pre><code class="language-shell">[root@node1 lfs-objects]# pwd
/data/gitlab/lfs-objects
[root@node1 lfs-objects]# ls
a9  tmp
[root@node1 lfs-objects]# tree
.
├── a9
│   └── d3
│        └── 9518c7f4f5426781bbbd90cf50169581e03b2f265d0b2443dff35c81ce80
└── tmp
    ├── cache
    ├── uploads
    └── work
 
6 directories, 1 file
[root@node1 lfs-objects]# cd a9/d3/
[root@node1 d3]# ll -h
total 1.3G
-rw-r--r--. 1 git git 1.3G Jul 14 16:43 9518c7f4f5426781bbbd90cf50169581e03b2f265d0b2443dff35c81ce80
</code></pre>
<p>通过文件大小直到，肯定即使我们上传得那个大文件！</p>
<p><strong>8、最后，肯定还得要测一下clone下载正不正常（git lfs clone …）：</strong></p>
<pre><code class="language-shell"># 通过git lfs clone 完成对包含LFS的项目的clone
$ git lfs clone http://10.206.73.159/jiguiquan/test-big-file.git
WARNING: 'git lfs clone' is deprecated and will not be updated
          with new flags from 'git clone'
 
'git clone' has been updated in upstream Git to have comparable
speeds to 'git lfs clone'.
Cloning into 'test-big-file'...
info: detecting host provider for 'http://10.206.73.159/'...
info: detecting host provider for 'http://10.206.73.159/'...
remote: Enumerating objects: 8, done.
remote: Counting objects: 100% (8/8), done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 8 (delta 0), reused 0 (delta 0), pack-reused 0
Receiving objects: 100% (8/8), done.
info: detecting host provider for 'http://10.206.73.159/'...
info: detecting host provider for 'http://10.206.73.159/'...
Downloading LFS objects:   0% (0/1), 92 MB | 3.7 MB/s
...
Downloading LFS objects:   0% (0/1), 501 MB | 2.0 MB/s
...
Receiving objects: 100% (8/8), done.
info: detecting host provider for 'http://10.206.73.159/'...
info: detecting host provider for 'http://10.206.73.159/'...
Downloading LFS objects: 100% (1/1), 1.3 GB | 1.6 MB/s
</code></pre>
<p>大文件Clone正常：</p>
<figure data-type="image" tabindex="8"><img src="https://www.jiguiquan.com/wp-content/uploads/image/20220714/1657791653691842.png" alt="image.png" loading="lazy"></figure>

          <div class="toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E4%B8%80-%E4%BD%BF%E7%94%A8%E6%B8%85%E5%8D%8E%E9%95%9C%E5%83%8F%E6%BA%90%E5%AE%89%E8%A3%85"><strong>一、使用清华镜像源安装</strong></a></li>
<li><a href="#%E4%BA%8C-gitlab%E7%9A%84%E5%90%AF%E5%8A%A8%E5%92%8C%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><strong>二、Gitlab的启动和常用命令</strong></a></li>
<li><a href="#%E4%B8%89-gitlab502%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF"><strong>三、Gitlab502问题解决思路</strong></a></li>
<li><a href="#%E5%9B%9B-gitlab%E7%9A%84%E4%BD%BF%E7%94%A8"><strong>四、Gitlab的使用</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
          <hr />
          
            <p class="prev-post">上一篇：
              <a href="https://tianxiawuhao.github.io/dpVtZ7y41/">
                <span class="post-title">
                  GitLab的安装与简单使用&rarr;
                </span>
              </a>
            </p>
          
          
          <p class="next-post">下一篇：
            <a href="https://tianxiawuhao.github.io/OxvAGnY87/">
              <span class="post-title">
                easeCode&rarr;
              </span>
            </a>
          </p>
          
          <div class="comment" style="text-align: center;">
            

            
            
          </div>
        </div>
      </div>
    </div>
  </article>
  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            
            
              
            
              
            
              
            
              
            
              
            
              
            
              
              <!-- <li class="list-inline-item">
              <a href="https://tianxiawuhao.github.io/atom.xml" target="_blank">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                </span>
              </a>
              </li> -->
          </ul>
          <p class="copyright text-muted">Copyright &copy;<span>tianxia</span><br><a href="https://github.com/getgridea/gridea" class="Themeinfo">Powered by Gridea</a></p>
        </div>
      </div>
    </div>
   </footer>
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <!-- <script src="https://tianxiawuhao.github.io/media/scripts/bootstrap.bundle.min.js"></script> -->
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.jsdelivr.net/gh/Alanrk/clean-cdn@1.0/scripts/clean-blog.min.js"></script>
  <!-- <script src="https://tianxiawuhao.github.io/media/scripts/clean-blog.min.js"></script> -->
  <script src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
  <style type="text/css">a.back_to_top{text-decoration:none;position:fixed;bottom:40px;right:30px;background:#f0f0f0;height:40px;width:40px;border-radius:50%;line-height:36px;font-size:18px;text-align:center;transition-duration:.5s;transition-propety:background-color;display:none}a.back_to_top span{color:#888}a.back_to_top:hover{cursor:pointer;background:#dfdfdf}a.back_to_top:hover span{color:#555}@media print,screen and(max-width:580px){.back_to_top{display:none!important}}</style>
<a id="back_to_top" href="#" class="back_to_top">
  <span>▲</span></a>
<script>$(document).ready((function(_this) {
    return function() {
      var bt;
      bt = $('#back_to_top');
      if ($(document).width() > 480) {
        $(window).scroll(function() {
          var st;
          st = $(window).scrollTop();
          if (st > 30) {
            return bt.css('display', 'block')
          } else {
            return bt.css('display', 'none')
          }
        });
        return bt.click(function() {
          $('body,html').animate({
            scrollTop: 0
          },
          800);
          return false
        })
      }
    }
  })(this));</script>
  
  <script src="https://tianxiawuhao.github.io/media/scripts/tocScript.js"></script>
</body>

</html>